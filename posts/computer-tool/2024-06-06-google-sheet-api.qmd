---
title: "Google Sheetì™€ íŒŒì´ì¬ ì—°ë™í•˜ê¸°" 
description: "ë°ì´í„° ì•± ë§Œë“¤ê¸°ì˜ ì‹œì‘"   
author: "JS HUHH"
date: "06/06/2024"
image: "./images/cats-spreadsheet.webp"
categories: [computer-tool, google-sheet, dashboard]
#fig-align: center
#jupyter: python3
draft: false
---


## TL; DR

- Google Sheetë¥¼ íŒŒì´ì¬ê³¼ ì—°ë™í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì.
- ğŸ”—[LINK](https://blog.lostineconomics.com/posts/computer-tool/2024-03-18-lazy-dashboard.html)ì™€ í•¨ê»˜ ì°¸ê³ í•˜ì‹œë¼.  

## ë°ì´í„° ì•± ë§Œë“¤ê¸°ì˜ 0ë‹¨ê³„

ë°ì´í„° ì•±ì„ ë§Œë“œëŠ” ìµœì´ˆì˜ ë‹¨ê³„ëŠ” ë°ì´í„°ì™€ ì´ë¥¼ ë‹¤ë£° ë„êµ¬(ì–¸ì–´)ì˜ ì—°ë™ì´ë‹¤. ë³„ë„ë¡œ DBë¥¼ ë§Œë“¤ì§€ ì•Šì„ ê²ƒì´ë¼ë©´ ë°ì´í„° ì†ŒìŠ¤ëŠ” ì•„ë§ˆë„ êµ¬ê¸€ ì‹œíŠ¸ë¥¼ í¬í•¨í•œ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ í˜•íƒœì¼ ê²ƒì´ë‹¤. ë°ì´í„° ì•±ì„ ë§Œë“¤ê¸°ë¡œ í–ˆë‹¤ë©´ ê°€ì¥ ë¨¼ì € í•´ì•¼ í•˜ëŠ” ê³ ë¯¼ì´ ì—¬ê¸° ìˆë‹¤. íŒŒì´ì¬ê³¼ êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ëŠ” ì–´ë–»ê²Œ ì—°ë™í•˜ë©´ ë ê¹Œ? ì´ í¬ìŠ¤íŠ¸ ì—­ì‹œ ë‚´ìš©ì„ ê¹Œë¨¹ì„ ë¯¸ë˜ì˜ ë‚˜ë†ˆì„ ìœ„í•œ ê²ƒì´ë‹¤. 

:::{.column-margin}
ê¸°ë³¸ì ì¸ ë‚´ìš©ì€ [LINK](ttps://www.analyticsvidhya.com/blog/2020/07/read-and-update-google-spreadsheets-with-python/)ë¥¼ ì°¸ê³ í–ˆë‹¤. 
:::

## Google Sheet API ì„¤ì •

### Google Cloud Consoleì—ì„œ í”„ë¡œì íŠ¸ ìƒì„± 

ë¨¼ì € ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ì ì ˆí•˜ê²Œ ìƒì„±í•˜ì. 

:::{layout="[[-0.5, 1, -0.5]]"}
![í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ì.](./images/gss-01.jpeg){#fig-1}
:::

### API í™œì„±í™”

APIë¥¼ í™œì„±í™”í•´ì•¼ í•œë‹¤. APIë¥¼ í™œì„±í™”í•˜ëŠ” ë©”ë‰´ì—ì„œ @fig-2\a ì™€ ê°™ì´ ë‘ ê°œì˜ APIë¥¼ í™œì„±í™”í•˜ì.  

í™œì„±í™”í•´ì•¼ í•˜ëŠ” APIëŠ” `Google Drive API`, `Google Sheets API` ë‘ ê°€ì§€ì´ë‹¤. 

:::{layout="[[-0.2, 1, -0.2]]"}
![Google Driveì™€ Google Sheet API í™œì„±í™”](./images/gss-02.jpeg){#fig-2}
:::

### ì‚¬ìš©ì ì¸ì¦ ì •ë³´ ë§Œë“¤ê¸° 

- êµ¬ê¸€ ì‹œíŠ¸ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ì„œëŠ” "ì„œë¹„ìŠ¤ ê³„ì •"(@fig-3)ìœ¼ë¡œ ë§Œë“¤ë„ë¡ í•˜ì. 
- ì‚¬ìš©ì ì¸ì¦ ì •ë³´ ìœ í˜•ì€ "ì–´í”Œë¦¬ì¼€ì´ì…˜ ë°ì´í„°"ì´ë‹¤(@fig-4). 

:::{layout="[[1, -0.1, 1]]" layout-valign="bottom"}
![ì„œë¹„ìŠ¤ ê³„ì • í™œì„±í™”](./images/gss-03.jpeg){#fig-3}

![API ì„¤ì •](./images/gss-04.jpeg){#fig-4}
:::

### í‚¤ ìƒì„±í•˜ê¸° 

- @fig-5\a ì—ì„œ ìƒì„±ëœ ì„œë¹„ìŠ¤ ê³„ì •ì„ í´ë¦­í•œë‹¤. 
- @fig-6\a ì—ì„œ ë³´ë“¯ì´ "í‚¤" íƒ­ì—ì„œ JSONìœ¼ë¡œ ìƒì„±í•˜ë©´ í•´ë‹¹ JSON íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œ ëœë‹¤. ì´ íŒŒì¼ì„ íŒŒì´ì¬ì—ì„œ êµ¬ê¸€ ì‹œíŠ¸ì— ì ‘ê·¼í•˜ëŠ”ë° í™œìš©í•œë‹¤. ì´ íŒŒì¼ì€ íŒ¨ìŠ¤ì›Œë“œê°€ ê°™ì€ ê²ƒì´ë¯€ë¡œ ë…¸ì¶œë˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ì.

:::{layout="[[1, -0.1, 1]]" layout-valign="bottom"}
![ë¡œë´‡ ê³„ì • ì„ íƒ](./images/gss-05.jpeg){#fig-5} 

![í‚¤ ìƒì„±](./images/gss-06.jpeg){#fig-6}
:::

:::{.column-margin}
public ê³„ì •ì˜ githubì— í¬ë¦¬ë´ì…œ íŒŒì¼ì„ ë„£ì–´ë‘ëŠ” ê²ƒì´ ê°€ì¥ í”í•œ ì‹¤ìˆ˜ì´ë‹¤. ì´ ì  ê°ë³„íˆ ì£¼ì˜í•˜ë„ë¡ í•˜ì. public ê³„ì •ì´ë¼ë„ ë§ˆìŠ¤í‚¹ ì²˜ë¦¬ê°€ ë¶€ë¶„ì ìœ¼ë¡œ ê°€ëŠ¥í•˜ê³ , private ê³„ì •ì´ë¼ê³  í•´ë„, GitHub Pages ì„œë¹„ìŠ¤ëŠ” ê°€ëŠ¥í•˜ë‹¤. 
:::

### Google Spread Sheet ê³µìœ í•˜ê¸°

êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ì˜ ìƒë‹¨ì˜ ê³µìœ  ë²„íŠ¼ì—ì„œ ì•ì„œ í¬ë¦¬ë´ì…œì„ ìƒì„±í•œ ë¡œë´‡ ìœ ì €ë¥¼ ê³µìœ ìë¡œ ì§€ì •í•œë‹¤. 

## íŒŒì´ì¬ì—ì„œ ì‘ì—…í•˜ê¸° 

ì„¤ì¹˜ ë“±ì˜ ê³¼ì •ì€ ìƒëµí•˜ê³  í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” ì½”ë“œë§Œ ê°„ëµí•˜ê²Œ ì†Œê°œí•œë‹¤. 

- ì•„ë˜ì˜ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ê³  ì„í¬íŠ¸í•œë‹¤. 

```python
#!pip3 install gspread
#!pip3 install --upgrade google-api-python-client oauth2client

#importing the required libraries
import gspread
import pandas as pd
from oauth2client.service_account import ServiceAccountCredentials
```

- í¬ë¦¬ë´ì…œì„ í™œìš©í•´ì„œ í•´ë‹¹ êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.
  - `add_json_file_here.json`ì— ì•ì„œ ë‹¤ìš´ë¡œë“œí•œ JSON íŒŒì¼ì„ ë„£ìœ¼ë©´ ëœë‹¤. 

```python
# define the scope
scope = ['https://spreadsheets.google.com/feeds','https://www.googleapis.com/auth/drive']

# add credentials to the account
creds = ServiceAccountCredentials.from_json_keyfile_name('add_json_file_here.json', scope)

# authorize the clientsheet 
client = gspread.authorize(creds)
```

- 'êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì„œë¹„ìŠ¤ ì´ë¦„'ì—ëŠ” ì ‘ê·¼í•  êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ì˜ íƒ€ì´í‹€ì„ ë„£ëŠ”ë‹¤. ì™¼ìª½ ìƒë‹¨ì— ìˆë‹¤. 

- ì„œë¹„ìŠ¤ ë‚´ì˜ ê°œë³„ ì‹œíŠ¸ì˜ ì„ íƒì€ ì•„ë˜ `get_worksheet(0)`ë¡œ í•œë‹¤. 0ë²ˆì´ ì²«ë²ˆì§¸ ìœ„ì¹˜í•œ ì‹œíŠ¸ì´ë‹¤. ì‹œíŠ¸ì˜ ìœ„ì¹˜ê°€ ë°”ë€Œë©´ ì´ ì—­ì‹œ ë”°ë¼ì„œ ë°”ë€Œì–´ì•¼ í•œë‹¤. 

```python
# get the instance of the Spreadsheet
sheet = client.open('êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì„œë¹„ìŠ¤ ì´ë¦„')

# get the first sheet of the Spreadsheet
sheet_instance = sheet.get_worksheet(0)
```

- `get_all_records()`ë¥¼ í†µí•´ ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆê³ , íŒŒì´ì¬ dictionary í˜•íƒœë¡œ ì €ì¥ëœë‹¤. ì´ë¥¼ pandasì˜ DataFrameìœ¼ë¡œ ë³€í™˜í•˜ë©´ ëœë‹¤.

```python
# get all the records of the data
records_data = sheet_instance.get_all_records()

# convert the json to dataframe
records_df = pd.DataFrame.from_dict(records_data)
```