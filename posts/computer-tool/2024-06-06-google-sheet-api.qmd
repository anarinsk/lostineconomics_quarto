---
title: "Google Sheetì™€ íŒŒì´ì¬ ì—°ë™í•˜ê¸°" 
description: "ë°ì´í„° ì•± ë§Œë“¤ê¸°ì˜ ì‹œì‘"   
author: "JS HUHH"
date: "06/06/2024"
image: "./images/cats-spreadsheet.webp"
categories: [computer-tool, google-sheet, dashboard]
lightbox: auto
#fig-align: center
filters:
   - lightbox
   #- line-highlight
#jupyter: python3
draft: false
format:
  html:
    highlight-style: github
    #code-line-numbers: true
    code-block-bg: true
    code-block-border-left: "#31BAE9"
---


## TL; DR

- Google Sheetë¥¼ íŒŒì´ì¬ê³¼ ì—°ë™í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì.
- ğŸ”—[LINK](https://blog.lostineconomics.com/posts/computer-tool/2024-03-18-lazy-dashboard.html)ì™€ í•¨ê»˜ ì°¸ê³ í•˜ì‹œë¼.  

## ë°ì´í„° ì•± ë§Œë“¤ê¸°ì˜ 0ë‹¨ê³„

ë”°ë¡œ DBë¥¼ ë§Œë“¤ì§€ ì•Šì„ ê²ƒì´ë¼ë©´ ë°ì´í„° ì†ŒìŠ¤ëŠ” ì—‘ì…€í˜•íƒœê°€ ê°€ì¥ í”í•  ê²ƒ ê°™ë‹¤. ê·¸ë¦¬ê³  ë°ì´í„°ê°€ ë‹¤ë¥¸ ì›ì²œì— ì˜í•´ì„œ ë³€í•œë‹¤ë©´ êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ê°€ ì‰¬ìš´ ì„ íƒì§€ê°€ ì•„ë‹ê¹Œ ì‹¶ë‹¤. ê·¸ë ‡ë‹¤ë©´ íŒŒì´ì¬ê³¼ êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ëŠ” ì–´ë–»ê²Œ ì—°ë™í•˜ë©´ ë ê¹Œ? ì´ í¬ìŠ¤íŠ¸ ì—­ì‹œ ë‚´ìš©ì„ ê¹Œë¨¹ì„ ë¯¸ë˜ì˜ ë‚˜ë†ˆì„ ìœ„í•œ ê²ƒì´ë‹¤. 

:::{.column-margin}
ê¸°ë³¸ì ì¸ ë‚´ìš©ì€ [LINK](ttps://www.analyticsvidhya.com/blog/2020/07/read-and-update-google-spreadsheets-with-python/)ë¥¼ ì°¸ê³ í–ˆë‹¤. 
:::

## Google Sheet API ì„¤ì •

### Google Cloud Consoleì—ì„œ í”„ë¡œì íŠ¸ ìƒì„± 

ë¨¼ì € ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ì ì ˆí•˜ê²Œ ìƒì„±í•˜ì. 

:::{layout="[[-0.5, 1, -0.5]]"}
![í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ì.](./images/gss-01.jpeg){#fig-1}
:::

### API í™œì„±í™”

APIë¥¼ í™œì„±í™”í•´ì•¼ í•œë‹¤. 

í™œì„±í™”í•´ì•¼ í•˜ëŠ” APIëŠ” `Google Drive API`, `Google Sheets API` ë‘ ê°€ì§€ì´ë‹¤. 

:::{layout="[[-0.2, 1, -0.2]]"}
![ë“œë¼ì´ë¸Œì™€ ì‹œíŠ¸ API í™œì„±í™”](./images/gss-02.jpeg){#fig-2}
:::

### ì‚¬ìš©ì ì¸ì¦ ì •ë³´ ë§Œë“¤ê¸° 

- "ì„œë¹„ìŠ¤ ê³„ì •"ìœ¼ë¡œ ë§Œë“¤ë„ë¡ í•˜ì. 
- ì‚¬ìš©ì ì¸ì¦ ì •ë³´ ìœ í˜•ì€ "ì–´í”Œë¦¬ì¼€ì´ì…˜ ë°ì´í„°"ì´ë‹¤. 

:::{layout="[[1, -0.1, 1]]" layout-valign="bottom"}
![ì„œë¹„ìŠ¤ ê³„ì • í™œì„±í™”](./images/gss-03.jpeg){#fig-3}

![API ì„¤ì •](./images/gss-04.jpeg){#fig-4}
:::

### í‚¤ ìƒì„±í•˜ê¸° 

- í‚¤ë¥¼ JSONìœ¼ë¡œ ìƒì„±í•˜ë©´ í•´ë‹¹ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œ ëœë‹¤. 

:::{layout="[[1, -0.1, 1]]" layout-valign="bottom"}
![ë¡œë´‡ ê³„ì • ì„ íƒ](./images/gss-05.jpeg){#fig-5} 

![í‚¤ ìƒì„±](./images/gss-06.jpeg){#fig-6}
:::

### Google Spread Sheet ê³µìœ í•˜ê¸°

êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ì˜ ìƒë‹¨ì˜ ê³µìœ  ë²„íŠ¼ì—ì„œ ì•ì„œ í¬ë¦¬ë´ì…œì„ ìƒì„±í•œ ë¡œë´‡ ìœ ì €ë¥¼ ê³µìœ ìë¡œ ì§€ì •í•œë‹¤. 

## íŒŒì´ì¬ì—ì„œ ì‘ì—…í•˜ê¸° 

ì„¤ì¹˜ ë“±ì˜ ê³¼ì •ì€ ìƒëµí•˜ê³  í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” ì½”ë“œë§Œ ê°„ëµí•˜ê²Œ ì†Œê°œí•œë‹¤. 

```python
#!pip3 install gspread
#!pip3 install --upgrade google-api-python-client oauth2client

#importing the required libraries
import gspread
import pandas as pd
from oauth2client.service_account import ServiceAccountCredentials
```

ì´ì œ í¬ë¦¬ë´ì…œì„ í™œìš©í•´ì„œ í•´ë‹¹ êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤. `add_json_file_here.json`ì— ì•ì„œ ë‹¤ìš´ë¡œë“œí•œ JSON íŒŒì¼ì„ ë„£ìœ¼ë©´ ëœë‹¤. 

```python
# define the scope
scope = ['https://spreadsheets.google.com/feeds','https://www.googleapis.com/auth/drive']

# add credentials to the account
creds = ServiceAccountCredentials.from_json_keyfile_name('add_json_file_here.json', scope)

# authorize the clientsheet 
client = gspread.authorize(creds)
```

'êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ ì´ë¦„'ì—ëŠ” ì ‘ê·¼í•  êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ì˜ íƒ€ì´í‹€ì„ ë„£ëŠ”ë‹¤. ì‹œíŠ¸ì˜ ì„ íƒì€ ì•„ë˜ `get_worksheet(0)`ë¡œ í•œë‹¤. 0ë²ˆì´ ì²«ë²ˆì§¸ ìœ„ì¹˜í•œ ì‹œíŠ¸ì´ë‹¤. 

```python
# get the instance of the Spreadsheet
sheet = client.open('êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ ì´ë¦„')

# get the first sheet of the Spreadsheet
sheet_instance = sheet.get_worksheet(0)
```

get_all_records()ë¥¼ í†µí•´ ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆê³ , dictionary í˜•íƒœë¡œ ì €ì¥ëœë‹¤. ì´ë¥¼ pandasì˜ DataFrameìœ¼ë¡œ ë³€í™˜í•˜ë©´ ëœë‹¤.

```python
# get all the records of the data
records_data = sheet_instance.get_all_records()

# convert the json to dataframe
records_df = pd.DataFrame.from_dict(records_data)
```